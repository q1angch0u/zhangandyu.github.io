<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">


<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>





<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">









  <meta name="keywords" content=",">





  <link rel="alternate" href="/atom.xml" title="怪兽宇的小站" type="application/atom+xml">






<meta name="description" content="python中的单引号，双引号，三引号的不同作用 Pandas简介Pandas是python数据分析中一个非常核心的数据库， 在日常的工作中经常需要使用Pandas库来对数据进行处理分析。Pandas的核心为两大数据结构， Series和DataFrame，Series用于存储一维数据， 而DataFrame存储多维数据。 常用的软件Anaconda是数据分析中运行python的一款利器， 安装教">
<meta name="keywords" content="Python">
<meta property="og:type" content="website">
<meta property="og:title" content="Pandas 库学习总结">
<meta property="og:url" content="https://zhangandyu.github.io/备份/文章备份/python/Pandas库学习总结.html">
<meta property="og:site_name" content="怪兽宇的小站">
<meta property="og:description" content="python中的单引号，双引号，三引号的不同作用 Pandas简介Pandas是python数据分析中一个非常核心的数据库， 在日常的工作中经常需要使用Pandas库来对数据进行处理分析。Pandas的核心为两大数据结构， Series和DataFrame，Series用于存储一维数据， 而DataFrame存储多维数据。 常用的软件Anaconda是数据分析中运行python的一款利器， 安装教">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-04-10T01:50:34.672Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pandas 库学习总结">
<meta name="twitter:description" content="python中的单引号，双引号，三引号的不同作用 Pandas简介Pandas是python数据分析中一个非常核心的数据库， 在日常的工作中经常需要使用Pandas库来对数据进行处理分析。Pandas的核心为两大数据结构， Series和DataFrame，Series用于存储一维数据， 而DataFrame存储多维数据。 常用的软件Anaconda是数据分析中运行python的一款利器， 安装教">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zhangandyu.github.io/备份/文章备份/python/Pandas库学习总结.html">





  <title>Pandas 库学习总结 | 怪兽宇的小站</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-127783955-1', 'auto');
  ga('send', 'pageview');
</script>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
	<a href="https://zhangandyu.github.io" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">怪兽宇的小站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">脚踏实地，仰望星空!</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

	<h1 class="post-title" itemprop="name headline">Pandas 库学习总结</h1>



</header>

      
      
      
      <div class="post-body">
        
        
          <p><a href="https://blog.csdn.net/woainishifu/article/details/76105667" target="_blank" rel="noopener">python中的单引号，双引号，三引号的不同作用</a></p>
<h1 id="Pandas简介"><a href="#Pandas简介" class="headerlink" title="Pandas简介"></a>Pandas简介</h1><p>Pandas是python数据分析中一个非常核心的数据库， 在日常的工作中经常需要使用Pandas库来对数据进行处理分析。Pandas的核心为两大数据结构， <strong>Series</strong>和<strong>DataFrame</strong>，Series用于存储一维数据， 而DataFrame存储多维数据。</p>
<h1 id="常用的软件"><a href="#常用的软件" class="headerlink" title="常用的软件"></a>常用的软件</h1><p>Anaconda是数据分析中运行python的一款利器， 安装教程可参考<br><a href="https://www.jianshu.com/p/169403f7e40c" target="_blank" rel="noopener">Anaconda入门使用指南</a></p>
<h1 id="Series对象"><a href="#Series对象" class="headerlink" title="Series对象"></a>Series对象</h1><p>Series用于存储一维数据，由两个相互关联的数组组成， 主数组用来存放数据。</p>
<ol>
<li>创建Series对象</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zy = pd.Series([2, 3, 4, 6, 7, 4], index = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;])</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>查看Series对象的两个数组</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 查看元素</span><br><span class="line">zy.values</span><br><span class="line"></span><br><span class="line"># 查看索引</span><br><span class="line">zy.index</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>查看元素</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 将zy看做Numpy数组，指定键</span><br><span class="line">zy[2]</span><br><span class="line">zy[0:2]</span><br><span class="line"></span><br><span class="line"># 指定标签</span><br><span class="line">zy[&apos;c&apos;]</span><br><span class="line">zy[[&apos;b&apos;, &apos;c&apos;]]</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>筛选元素</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zy[zy &gt;3]</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>查看组成元素</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 查看包含的不同元素</span><br><span class="line">zy.unique()</span><br><span class="line">zy.value_counts()</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>通过字典来创建</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zy=Series(&#123;&apos;a&apos;:1,&apos;b&apos;:2,&apos;c&apos;:3&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="时间函数"><a href="#时间函数" class="headerlink" title="时间函数"></a>时间函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">from datetime import datetime, time, timedelta</span><br></pre></td></tr></table></figure>
<ul>
<li>现在时间</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">now = datetime.now()</span><br></pre></td></tr></table></figure>
<ul>
<li><p>昨天</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ysd = now - timedelta(days = 1)</span><br><span class="line">ysd = now.replace(day = now.day-1)</span><br></pre></td></tr></table></figure>
</li>
<li><p>本月第一天</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">month_first = now.replace(day = 1)</span><br></pre></td></tr></table></figure>
</li>
<li><p>上月最后一天</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lastmonth_end = month_first - timedelta(days=1)</span><br></pre></td></tr></table></figure>
</li>
<li><p>上月第一天</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lastmonth_first = now.replace(month = now.month-1, day =1)</span><br><span class="line"></span><br><span class="line">lastmonth_first = lastmonth_end.replace(day=1)</span><br></pre></td></tr></table></figure>
</li>
<li><p>转化为日期形式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this_firsts = lastmonth_first.__format__(&quot;%Y-%m-%d&quot;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h3 id="读取与写入Excel数据"><a href="#读取与写入Excel数据" class="headerlink" title="读取与写入Excel数据"></a>读取与写入Excel数据</h3><ol>
<li>读取文件夹的内容</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">from pandas import Series, DataFrame</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file_list = os.listdir(r&apos;E:\工作文件\周报\周数据\测试\0902-0908&apos;)</span><br><span class="line">print(file_list, &apos;\t&apos;)</span><br><span class="line"></span><br><span class="line"># 读取当前文件夹地址</span><br><span class="line">os.getwd()</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>读取xls格式Excel表</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_excel(&apos;E:/工作文件/周报/周数据/测试/0902-0908/an-商品汇总-uv.xls&apos;)</span><br><span class="line">df = pd.read_excel(r&apos;E:\工作文件\周报\周数据\测试\0902-0908\an-商品汇总-uv.xls&apos;)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(r&apos;E:\工作文件\周报\周数据\测试\0902-0908\an-商品汇总-uv.xlsx&apos;)</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>读取csv格式Excel表</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(&apos;E:/工作文件/周报/周数据/测试/0902-0908/商品汇总.csv&apos;)</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>读取txt格式数据</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_table(r&apos;C:\Users\Administrator\Desktop\haha.txt&apos;)</span><br><span class="line"></span><br><span class="line">with open(r&apos;C:\Users\Administrator\Desktop\haha.txt&apos;, &apos;r&apos;) as f:</span><br><span class="line">    df = f.readlines() </span><br><span class="line"></span><br><span class="line">df = np.loadtxt(r&apos;C:\Users\Administrator\Desktop\haha.txt&apos;)  # 将txt文件存为numpy数组</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>将数据写入Excel表， 并输出</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data.to_excel(&apos;C:/Users/Administrator/Desktop/&apos;+&apos;商品分类.xlsx&apos;)</span><br><span class="line">data.to_excel(r&apos;C:\Users\Administrator\Desktop\\&apos;+&apos;商品分类.xlsx&apos;)</span><br><span class="line">data.to_excel(r&apos;C:\Users\Administrator\Desktop/&apos;+&apos;商品分类.xlsx&apos;)</span><br></pre></td></tr></table></figure>
<ol start="6">
<li><p>其他数据格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 从SQL表/库导入数据 </span><br><span class="line">pd.read_sql(query, connection_object)</span><br><span class="line"></span><br><span class="line"># 从JSON格式的字符串导入数据 </span><br><span class="line">pd.read_json(json_string)</span><br><span class="line"></span><br><span class="line"># 解析URL、字符串或者HTML文件，抽取其中的tables表格 </span><br><span class="line">pd.read_html(url)</span><br><span class="line"></span><br><span class="line"># 从你的粘贴板获取内容，并传给read_table() </span><br><span class="line">pd.read_clipboard()</span><br><span class="line"></span><br><span class="line"># 从字典对象导入数据，Key是列名，Value是数据</span><br><span class="line">pd.DataFrame(dict)</span><br><span class="line"></span><br><span class="line"># 导出数据到SQL表 </span><br><span class="line">df.to_sql(table_name, connection_object)</span><br><span class="line"></span><br><span class="line"># 以Json格式导出数据到文本文件</span><br><span class="line">df.to_json(filename)</span><br></pre></td></tr></table></figure>
</li>
<li><p>常见问题：</p>
</li>
</ol>
<ul>
<li>当文件有中文时， 可能会出现错误：Initializing from file failed 有中文， 可以用此方法解决</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f = open(&apos;我的文件.csv&apos;)</span><br><span class="line">res = pd.read_csv(f)</span><br></pre></td></tr></table></figure>
<ul>
<li>修改数据格式，并存储</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">#切换工作目录</span><br><span class="line">os.chdir(r&apos;E:\detil_data&apos;)</span><br><span class="line"></span><br><span class="line"># 显示当前目录</span><br><span class="line"># os.getcwd()</span><br><span class="line"></span><br><span class="line"># 将目录变成列表</span><br><span class="line">data = os.listdir()</span><br><span class="line"></span><br><span class="line"># for 循环此目录</span><br><span class="line"></span><br><span class="line">for i in data:</span><br><span class="line">    a = open(i)</span><br><span class="line">    datas = pd.read_csv(a)</span><br><span class="line">    datas.to_csv(&apos;F:\\zy_data\\文件\\&apos;+ i +&apos;222.csv&apos;, index=False,encoding=&apos;utf_8_sig&apos; )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#datas = pd.read_csv(&apos;a.csv&apos;,encoding=&apos;gbk&apos;)</span><br><span class="line"># datas.to_csv(&apos;test12.csv&apos;, index=False,encoding=&apos;utf_8_sig&apos; )</span><br></pre></td></tr></table></figure>
<ul>
<li><p>将求出的数据存储在excel中的多个sheet中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">from openpyxl import load_workbook</span><br><span class="line"> </span><br><span class="line">writer = pd.ExcelWriter(&apos;F:/notebooks/zy_zhoushuju/zhoushuju.xlsx&apos;)</span><br><span class="line"></span><br><span class="line">btn_navigation.to_excel(writer, sheet_name = &apos;底部导航&apos;)</span><br><span class="line">shouye_top20.to_excel(writer, sheet_name = &apos;首页top20&apos;)</span><br><span class="line">shouyedier_top2.to_excel(writer, sheet_name = &apos;首页第二屏top20&apos;)</span><br><span class="line">writer.save()</span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>
</li>
<li><p>当文件特别大， 1个多G时， 可以用for循环查看数据</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for i in data:</span><br><span class="line">    print(i)</span><br></pre></td></tr></table></figure>
<ul>
<li>查看大文件有多少列</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = open(&apos;E:/电信活跃用户数/2018-09-01至2018-09-11全国活跃用户明细.csv&apos;)</span><br><span class="line">data1 = pd.read_csv(data, iterator=True)</span><br><span class="line">data2 = data1.get_chunk(5)</span><br><span class="line">print(data2)</span><br></pre></td></tr></table></figure>
<p><a href="http://wiki.jikexueyuan.com/project/explore-python/Advanced-Features/iterator.html" target="_blank" rel="noopener">迭代器</a></p>
<h3 id="描述数据"><a href="#描述数据" class="headerlink" title="描述数据"></a>描述数据</h3><ol>
<li>表信息</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>显示数据的行列数</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.shape</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>查看数据格式dtpyes</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>显示列名、元素</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.columns</span><br><span class="line">df.values</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>添加默认列名</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 如果数据没有标题行，可用pandas添加默认的列名</span><br><span class="line">df = pd.read_excel(&apos;x.xlsx&apos;, header = None)</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>显示前数据前5行</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.head(5)</span><br><span class="line">df[[&apos;标题&apos;, &apos;客户端uv&apos;]].head()</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>显示数据后5行</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.tail(5)</span><br></pre></td></tr></table></figure>
<ol start="8">
<li>值</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.values</span><br></pre></td></tr></table></figure>
<ol start="9">
<li>读取a列</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&apos;a&apos;]</span><br></pre></td></tr></table></figure>
<ol start="10">
<li>修改索引</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = df.set_index[&apos;标题&apos;]</span><br></pre></td></tr></table></figure>
<ol start="11">
<li>显示数据唯一值（unique函数）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 数据有0， 是因对缺失值进行了填充</span><br><span class="line">df[&apos;经纪人级别&apos;].unique()</span><br></pre></td></tr></table></figure>
<ol start="12">
<li>对第几行数据不读取</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#不读取哪里数据，可用skiprows=[i]，跳过文件的第i行不读取</span><br><span class="line">df = pd.read_excel(&apos;x.xlsx&apos;,skiprows=[2] )</span><br></pre></td></tr></table></figure>
<ol start="13">
<li>对缺失值进行识别</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 所有缺失值显示为True</span><br><span class="line">pd.insull(df)  # df.isnull()</span><br></pre></td></tr></table></figure>
<ol start="14">
<li>计算</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#计算此data的数量</span><br><span class="line">df[&apos;data&apos;].value_counts()</span><br><span class="line"></span><br><span class="line"># 升序计数</span><br><span class="line">df[&apos;data&apos;].value_counts(ascending = True)</span><br><span class="line"></span><br><span class="line"># 升序计数并分组</span><br><span class="line">df[&apos;data&apos;].value_counts(ascending = True, bins = 2)</span><br><span class="line"></span><br><span class="line"># 计数</span><br><span class="line">df[&apos;data&apos;].count()</span><br></pre></td></tr></table></figure>
<h3 id="数据清洗"><a href="#数据清洗" class="headerlink" title="数据清洗"></a>数据清洗</h3><ol>
<li>删除空值 （dropna函数）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dropna(how=&apos;any&apos;)</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>填充空值（fillna函数）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 空值用0填充</span><br><span class="line">df.fillna(value=0)</span><br><span class="line"></span><br><span class="line"># 用均值对空值进行填充</span><br><span class="line">df[&apos;经纪人响应时长&apos;].fillna(df[&apos;经纪人响应时长&apos;].mean())</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>更改数据格式</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 将数据格式int64,改为float格式</span><br><span class="line">df[&apos;大区&apos;].astype(&apos;float64&apos;)</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>更改列名称, 修改列名。 </li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data2.columns = [[&apos;导航&apos;,&apos;uv&apos;, &apos;pv&apos;,&apos;户均点击&apos;]]</span><br><span class="line"></span><br><span class="line">df.rename(columns=&#123;&apos;IM渠道&apos;: &apos;渠道&apos;&#125;)</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>找到重复值</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.duplicated()</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>删除重复值</li>
</ol>
<p><a href="https://www.cnblogs.com/cocowool/p/8421997.html" target="_blank" rel="noopener">https://www.cnblogs.com/cocowool/p/8421997.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 默认第一次出现的保留，其余删除</span><br><span class="line">df[&apos;门店&apos;].drop_duplicates()</span><br><span class="line"></span><br><span class="line">最后一次出现的保留，其余删除</span><br><span class="line">df[&apos;门店&apos;].drop_duplicates(keep = &apos;last&apos;)</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>对列表内的值进行替换</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[&apos;客户UCID&apos;].replace(&apos;10531975&apos;, &apos;110&apos;)</span><br></pre></td></tr></table></figure>
<ol start="8">
<li>找出异常值</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(data.describe())</span><br><span class="line"># 对异常值进行删除</span><br></pre></td></tr></table></figure>
<ol start="9">
<li>修改数据</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 修改结果</span><br><span class="line">df.replace(参数)</span><br><span class="line"></span><br><span class="line"># 修改索引</span><br><span class="line">df.rename(参数)</span><br><span class="line"></span><br><span class="line"># 增加, 将一列数据添加到另一列数据后。 </span><br><span class="line">df.append(参数)</span><br><span class="line"></span><br><span class="line"># 删除</span><br><span class="line">def df[&apos;a&apos;]</span><br><span class="line"></span><br><span class="line">df.drop([&apos;a&apos;, &apos;b&apos;], inplace = True)</span><br></pre></td></tr></table></figure>
<h3 id="对数据进行处理"><a href="#对数据进行处理" class="headerlink" title="对数据进行处理"></a>对数据进行处理</h3><ol>
<li>对两个数据进行合并- mearge, join, concat函数</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># 按照轴把多个对象拼接起来</span><br><span class="line">pd.concat(df1, df2)</span><br><span class="line"></span><br><span class="line"># join函数适合根据索引进行合并，合并索引相同但列不同的对象</span><br><span class="line"></span><br><span class="line"># merge函数，根据一个或多个键连接多行, 相当于excel中的vlookup</span><br><span class="line"></span><br><span class="line">left = pd.DataFrame(&#123;&apos;key&apos;:[&apos;ko&apos;,&apos;k1&apos;,&apos;k2&apos;,&apos;k3&apos;],</span><br><span class="line">                     &apos;key2&apos; : [&apos;ko&apos;,&apos;k1&apos;,&apos;k2&apos;,&apos;k3&apos;],</span><br><span class="line">                     &apos;A&apos; :[&apos;ao&apos;,&apos;a1&apos;,&apos;a2&apos;,&apos;a3&apos; ],</span><br><span class="line">                     &apos;B&apos; : [&apos;bo&apos;,&apos;b1&apos;,&apos;b2&apos;,&apos;b3&apos; ]&#125;)</span><br><span class="line"></span><br><span class="line">right =pd.DataFrame(&#123;&apos;key&apos;:[&apos;ko&apos;,&apos;k1&apos;,&apos;k2&apos;,&apos;k3&apos;],</span><br><span class="line">                     &apos;key2&apos; : [&apos;ko&apos;,&apos;k1&apos;,&apos;k2&apos;,&apos;k4&apos;],</span><br><span class="line">                     &apos;c&apos; :[&apos;co&apos;,&apos;c1&apos;,&apos;c2&apos;,&apos;c3&apos; ],</span><br><span class="line">                     &apos;d&apos; : [&apos;do&apos;,&apos;d1&apos;,&apos;d2&apos;,&apos;d3&apos; ]&#125;)</span><br><span class="line"></span><br><span class="line"># 将left和right进行合并</span><br><span class="line">pd.merge(left, right)</span><br><span class="line"></span><br><span class="line"># 指定以key为键进行合并</span><br><span class="line">pd.merge(left, right, on = &apos;key&apos;)</span><br><span class="line"> pd.merge(name_3, name_1, left_on = [&apos;ming&apos;], right_on = [&apos;标记&apos;])</span><br><span class="line"></span><br><span class="line"># key2列不相同的部分会直接舍弃掉</span><br><span class="line">pd.merge(left, right, on = [&apos;key&apos;, &apos;key2&apos;])</span><br><span class="line"></span><br><span class="line"># 保留key2列不相同的部分</span><br><span class="line">pd.merge(left, right, on = [&apos;key&apos;, &apos;key2&apos;], how = &apos;outer&apos;)</span><br><span class="line"></span><br><span class="line"># 不相同的部分指定以左表为基准</span><br><span class="line">pd.merge(left, right, on = [&apos;key&apos;, &apos;key2&apos;], how = &apos;left&apos;)</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>将 list 格式转化成 DataFrame 格式</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(data, columns = [&apos;省份&apos;, &apos;按钮名称&apos;, &apos;uv&apos;, &apos;pv&apos;] )</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>对数据进行排序</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data =pd.DataFrame(&#123; &apos;group&apos;:[&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;a&apos;],</span><br><span class="line">                  &apos;data&apos; : [4, 2, 5, 6, 7, 8, 2, 9, 4]&#125;)</span><br><span class="line"></span><br><span class="line"># 在保证group列降序的情况下，对data列进行升序处理</span><br><span class="line">data.sort_values(by = [&apos;group&apos;, &apos;data&apos;],ascending = [False, True], inplace = True)</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>对数据进行分组——excel中的数据透视表</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 如果price列的值&gt;3000，group列显示high，否则显示low</span><br><span class="line"></span><br><span class="line">df[&apos;group&apos;] = np.where(df[&apos;客户当天发送消息数&apos;] &gt; 5,&apos;high&apos;,&apos;low&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 对符合多个条件进行分组</span><br><span class="line"># 符合经纪人级别为A1且经纪人响应时长&gt;24的在sign列显示为1</span><br><span class="line"></span><br><span class="line">df.loc[(df[&apos;经纪人级别&apos;] == &apos;A1&apos;) &amp; (df[&apos;经纪人响应时长&apos;]&gt;= 24.0), &apos;sign&apos;]=1</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>对数据进行分列</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.DataFrame((x.split(&apos;网&apos;) for x in df[&apos;客户注册渠道&apos;]),</span><br><span class="line">                index=df.index,columns=[&apos;客户注册渠道&apos;,&apos;size&apos;])</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>新增一列</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data = data.assign(ration = [4, 2, 5, 6, 7, 8, 2, 9, 4])</span><br><span class="line"></span><br><span class="line">data[&apos;rations&apos;] = [5, 2, 5, 6, 7, 8, 2, 9, 4]</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>对数据进行切分</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bins = [1,3,6,9]</span><br><span class="line">data_cut = pd.cut(data[&apos;data&apos;], bins)</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>取出的数据， 指定取到小数点几位数？</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 取到小数点后3位</span><br><span class="line">for i in a :</span><br><span class="line">      print(&quot;)</span><br></pre></td></tr></table></figure>
<h3 id="对数据进行提取-筛选"><a href="#对数据进行提取-筛选" class="headerlink" title="对数据进行提取,筛选"></a>对数据进行提取,筛选</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;&apos;A&apos;:[7,8,9,20, 10, 11, 14, 13, 14],</span><br><span class="line">                     &apos;B&apos; : [1,2,3,4,5, 6, 7, 7, 8]&#125;)</span><br></pre></td></tr></table></figure>
<ol>
<li>按条件进行提取</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># 选出B列的值大于3的数</span><br><span class="line">df[df[&apos;B&apos;]&gt;3]</span><br><span class="line"></span><br><span class="line"># 当 A列的值大于13时， 显示B，c列的值</span><br><span class="line">df[[&apos;B&apos;,&apos;C&apos;]][df[&apos;A&apos;]&gt;13]</span><br><span class="line"></span><br><span class="line"># 用isin函数进行判断</span><br><span class="line"></span><br><span class="line"># 使用isin函数根据特定值筛选记录。筛选A值等于10或者13的记录</span><br><span class="line">df[df.A.isin((10, 13))]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 判断经纪人级别是否为A3</span><br><span class="line">df[&apos;经纪人级别&apos;].isin([&apos;A3&apos;])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> # 先判断结果，将结果为True的提取</span><br><span class="line">#先判断经纪人级别列里是否包含A3和M4，然后将复合条件的数据提取出来。</span><br><span class="line">df.loc[df[&apos;经纪人级别&apos;].isin([&apos;A3&apos;,&apos;M4&apos;])]</span><br><span class="line"></span><br><span class="line"># 使用&amp;（并）与| （或）操作符或者特定的函数实现多条件筛选 </span><br><span class="line"></span><br><span class="line"># A列值大于10， 并且B列值大于5</span><br><span class="line">df[(df[&apos;A&apos;] &gt; 10) &amp; (df[&apos;B&apos;] &gt;5)]</span><br><span class="line">df[np.logical_and(df[&apos;A&apos;] &gt; 10, df[&apos;B&apos;] &gt; 5)]</span><br><span class="line"></span><br><span class="line"># A列值大于10，或 B列值大于5</span><br><span class="line">df[(df[&apos;A&apos;] &gt; 10) | (df[&apos;C&apos;] &gt;20)]</span><br><span class="line">df[np.logical_or(df[&apos;A&apos;] &gt; 10, df[&apos;C&apos;] &gt; 20)]</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>按索引进行提取</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"># 按标签索引</span><br><span class="line">df[1:4]</span><br><span class="line"></span><br><span class="line"># 传入列名</span><br><span class="line">df[[&apos;A&apos;, &apos;B&apos;]]</span><br><span class="line"></span><br><span class="line"># loc函数</span><br><span class="line"># 知道column names 和index(这里df的index没有指定，是默认生成的下标)，且两者都很好输入，可以选择 .loc同时进行行列选择</span><br><span class="line"></span><br><span class="line"># 根据标签取第一行， 显示为DataFrame格式</span><br><span class="line">df.loc[:0]</span><br><span class="line"></span><br><span class="line"># 取标签为2,3,4， A列的数据， 显示为Series格式</span><br><span class="line">df.loc[2:4, &apos;A&apos;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># iloc函数</span><br><span class="line"># 行和列都用index来进行提取</span><br><span class="line">df.iloc[0:5, 1:3] </span><br><span class="line"></span><br><span class="line"># 返回第一行 </span><br><span class="line">df.iloc[0,:]</span><br><span class="line"></span><br><span class="line"># 返回第一列的第一个元素</span><br><span class="line">df.iloc[0,0]</span><br><span class="line"></span><br><span class="line">#[0, 2, 5] 代表指定的行，[ 4, 5 ] 代表指定的列</span><br><span class="line">df.iloc[[0,2,5],[4,5]]</span><br><span class="line"></span><br><span class="line"># ix</span><br><span class="line">#ix的功能更加强大，参数既可以是索引，也可以是名称，相当于，loc和iloc的合体</span><br><span class="line"></span><br><span class="line">df.ix[1:3, [&apos;A&apos;, &apos;B&apos;]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># at函数</span><br><span class="line">根据指定行index及列label，快速定位DataFrame的元素，选择列时仅支持列名</span><br><span class="line">df.at[3, &apos;A&apos;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># iat函数</span><br><span class="line">选择时只使用索引参数</span><br><span class="line">df.iat[3, 2]</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>按日期进行提取</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">import pandas</span><br><span class="line">import datetime as dt</span><br><span class="line"></span><br><span class="line"># 重新设置索引</span><br><span class="line">df.reset_index()</span><br><span class="line"></span><br><span class="line">#设置日期为索引</span><br><span class="line">df=df.set_index(&apos;日期&apos;)</span><br><span class="line"></span><br><span class="line">#提取2016年11月2号的数据</span><br><span class="line">df[&apos;2016-11-02&apos; : &apos;2016-11-02&apos;]</span><br><span class="line"></span><br><span class="line">dt_time = dt.datetime(year = 2018, month=9, day = 17, hour = 22, minute = 43)</span><br><span class="line">print(dt_time)</span><br><span class="line"></span><br><span class="line">#构造时间</span><br><span class="line">ts = pd.Timestamp(&apos;2018-09-17 22:43:00&apos;)</span><br><span class="line">ts = pd.to_datetime(&apos;2018-09-17 22:43:00&apos;)</span><br><span class="line">ts = pd.to_datetime(&apos;17/09/2018 22:43:00&apos;)</span><br><span class="line"></span><br><span class="line"># 月份</span><br><span class="line">ts.month</span><br><span class="line"></span><br><span class="line">#日期</span><br><span class="line">ts.day</span><br><span class="line"></span><br><span class="line"># 加日期</span><br><span class="line">ts + pd.Timedelta(&apos; 10 days&apos;)</span><br><span class="line"></span><br><span class="line">ts.hour</span><br><span class="line"></span><br><span class="line"># 构造时间序列， 构造十个日期， 每12分钟一次</span><br><span class="line">pd.Series(pd.date_range(start = &apos;2018-09-17 22:43:00&apos;, periods = 10, freq = &apos;12min&apos;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">读取文件， 有时间列， 先将时间字符串转换成时间格式， 再进行处理</span><br><span class="line">或当读取数据时， 就对数据格式进行修改</span><br><span class="line"></span><br><span class="line">data = pd.read_csv(&apos;.../db.csv&apos;, index_col = 0, parse_dates = True)</span><br><span class="line"></span><br><span class="line"># 读取时间为2013年的所有数据</span><br><span class="line">data[&apos;2013&apos;]</span><br><span class="line"></span><br><span class="line"># 取所有8点到12点之间的数据, 不包含8点和12点</span><br><span class="line">data[(data.index.hour &gt; 8) &amp; (data.index.hour &lt; 12)]</span><br><span class="line"></span><br><span class="line"># 包含8点到12点</span><br><span class="line">data.between_time(&apos;08:00&apos;, &apos;12:00&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 时间序列的重采样-看每月的平均值</span><br><span class="line">data.resample(&apos;M&apos;).mean()</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="数据汇总"><a href="#数据汇总" class="headerlink" title="数据汇总"></a>数据汇总</h3><ol>
<li>对数据进行分类 - group by函数</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># 创建数组</span><br><span class="line">df = pd.DataFrame(&#123;&apos;key&apos; : [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;,&apos;a&apos;, &apos;b&apos;, &apos;c&apos;,&apos;a&apos;, &apos;b&apos;, &apos;c&apos;],</span><br><span class="line">                    &apos;data&apos; : [0, 2, 4, 5, 6, 7, 8, 9, 4]&#125;)</span><br><span class="line"></span><br><span class="line"># 分别计算a, b, c 的和</span><br><span class="line">df.groupby(&apos;key&apos;)[&apos;data&apos;].sum()</span><br><span class="line"></span><br><span class="line">df.groupby(&apos;key&apos;)[&apos;data&apos;].mean()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = pd.Series([1, 2, 3,1, 2, 3],[8,7,6,8,7,6])</span><br><span class="line"></span><br><span class="line"># 对索引进行排序</span><br><span class="line">grouped = s.groupby(level = 0， sort =False)</span><br><span class="line">grouped.first()</span><br><span class="line"></span><br><span class="line">df2 = pd.DataFrame(&#123;&apos;x&apos;:[&apos;a&apos;, &apos;b&apos;, &apos;a&apos;, &apos;b&apos;],</span><br><span class="line">                   &apos;y&apos; : [1, 2, 3, 4]&#125;)</span><br><span class="line"></span><br><span class="line"># 只关注x中的b</span><br><span class="line">df3 = df2.groupby([&apos;x&apos;]).get_group(&apos;b&apos;)</span><br><span class="line"></span><br><span class="line"># 查看个数</span><br><span class="line">df2.size()</span><br></pre></td></tr></table></figure>
<p>2, 对数据进行透视, 相当于Excel中的数据透视表功能。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pd.pivot_table(data, values=None, index=None, columns=None, aggfunc=&apos;mean&apos;)</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;&quot;A&quot;: [&quot;foo&quot;, &quot;foo&quot;, &quot;foo&quot;, &quot;foo&quot;, &quot;foo&quot;,</span><br><span class="line">                          &quot;bar&quot;, &quot;bar&quot;, &quot;bar&quot;, &quot;bar&quot;],</span><br><span class="line">                    &quot;B&quot;: [&quot;one&quot;, &quot;one&quot;, &quot;one&quot;, &quot;two&quot;, &quot;two&quot;,</span><br><span class="line">                          &quot;one&quot;, &quot;one&quot;, &quot;two&quot;, &quot;two&quot;],</span><br><span class="line">                    &quot;C&quot;: [&quot;small&quot;, &quot;large&quot;, &quot;large&quot;, &quot;small&quot;,</span><br><span class="line">                          &quot;small&quot;, &quot;large&quot;, &quot;small&quot;, &quot;small&quot;,</span><br><span class="line">                          &quot;large&quot;],</span><br><span class="line">                    &quot;D&quot;: [1, 2, 2, 3, 3, 4, 5, 6, 7]&#125;)</span><br><span class="line"></span><br><span class="line">table = pd.pivot_table(df, values=&apos;D&apos;, index=[&apos;A&apos;, &apos;B&apos;],</span><br><span class="line">                     columns=[&apos;C&apos;], aggfunc=np.sum)</span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>对数据进行映射</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 用map函数对字典进行映射， 新加一列</span><br><span class="line">data[&apos;upper&apos;] = data[&apos;group&apos;].map(dataUpper)</span><br></pre></td></tr></table></figure>
<h3 id="数据统计"><a href="#数据统计" class="headerlink" title="数据统计"></a>数据统计</h3><ol>
<li>数据采样</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 简单随机抽取sample</span><br><span class="line">df.sample(n=3)</span><br><span class="line"></span><br><span class="line"># 设置采样权重</span><br><span class="line"># 需要对每一行进行权重设置，列表行数少可行，过多不可行</span><br><span class="line"></span><br><span class="line"># 假设有4行数据，设置采样权重</span><br><span class="line">weights = [0, 0, 0.5, 0.5]</span><br><span class="line">df.sample(n=4, weights=weights)</span><br><span class="line"></span><br><span class="line">## 确定采样后是否放回</span><br><span class="line"># 采样后放回，True</span><br><span class="line">df.sample(n=6, replace=True)</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>统计计算</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 描述统计 describe函数</span><br><span class="line"></span><br><span class="line">#自动生成数据的数量，均值，标准差等数据</span><br><span class="line">#round（2）,显示小数点后面2位数，T转置</span><br><span class="line"></span><br><span class="line">df.describe().round(2).T</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 标准差std()</span><br><span class="line">df[&apos;经纪人响应时长&apos;].std()</span><br><span class="line"></span><br><span class="line"># 协方差cov</span><br><span class="line">df[&apos;经纪人当天发送消息数&apos;].cov(df[&apos;客户当天发送消息数&apos;]</span><br><span class="line"></span><br><span class="line"># 相关性分析corr</span><br><span class="line">df[&apos;客户当天发送消息数&apos;].corr(df[&apos;经纪人当天发送消息数&apos;])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 中位数</span><br><span class="line">df.median()</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="对字符串进行操作"><a href="#对字符串进行操作" class="headerlink" title="对字符串进行操作"></a>对字符串进行操作</h3><ol>
<li>大小写</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.lower()</span><br><span class="line">a.upper()</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>长度</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 长度</span><br><span class="line">a.len()</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>去除空格</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a.strip()</span><br><span class="line">a.lstrip()</span><br><span class="line">alrstrip()</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>替换</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columns.str.replace(&apos; &apos;, &apos;_&apos;)</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>切分与分列、 合并</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#切分</span><br><span class="line">a.split(&apos;_&apos;)</span><br><span class="line"></span><br><span class="line"># 切分， 且成为新列</span><br><span class="line">a.split(&apos;_&apos;, expand = True)</span><br><span class="line"></span><br><span class="line"># 对切分进行限制, 只切1次</span><br><span class="line">a.split(&apos;_&apos;, expand = True, n=1)</span><br><span class="line"></span><br><span class="line"># 查看是否包含</span><br><span class="line">a.str.contains(&apos;A&apos;)</span><br><span class="line"></span><br><span class="line"># 分列</span><br><span class="line">s.str.get_dummies(sep= &apos;|&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">对两列数据进行合并</span><br><span class="line">df[&apos;省份_名称&apos;] = df[&apos;省份&apos;].str.cat(df[&apos;名称&apos;],sep = &apos;_&apos;)</span><br></pre></td></tr></table></figure>
<h3 id="读取excel-中的各个sheeht名称，并且进行合并"><a href="#读取excel-中的各个sheeht名称，并且进行合并" class="headerlink" title="读取excel 中的各个sheeht名称，并且进行合并"></a>读取excel 中的各个sheeht名称，并且进行合并</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">rbook = []</span><br><span class="line">kong_data = os.listdir(r&apos;F:\zy_data\省资源位数据\3月省资源位数据\省资源位&apos;)</span><br><span class="line">for file_name in kong_data:</span><br><span class="line">    data_excel = pd.ExcelFile(r&apos;F:\zy_data\省资源位数据\3月省资源位数据\省资源位\\&apos;+file_name)</span><br><span class="line">    sheet = data_excel.sheet_names</span><br><span class="line">    for i in sheet:</span><br><span class="line">        data_button_rest = pd.read_excel(r&apos;F:\zy_data\省资源位数据\3月省资源位数据\省资源位\\&apos;+file_name, sheet_name= i )</span><br><span class="line">        rbook.append(data_button_rest)</span><br><span class="line">        result_df =pd.concat(rbook)</span><br><span class="line">datas_excel = pd.DataFrame(result_df)</span><br></pre></td></tr></table></figure>
<h3 id="将运行的所有数据都展现出来，-而不是只展现最后一条"><a href="#将运行的所有数据都展现出来，-而不是只展现最后一条" class="headerlink" title="将运行的所有数据都展现出来， 而不是只展现最后一条"></a>将运行的所有数据都展现出来， 而不是只展现最后一条</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from  IPython.core.interactiveshell import InteractiveShell</span><br><span class="line">InteractiveShell.ast_node_interactivity = &quot;all&quot;</span><br></pre></td></tr></table></figure>
<h3 id="字符和数值之间的转化"><a href="#字符和数值之间的转化" class="headerlink" title="字符和数值之间的转化"></a>字符和数值之间的转化</h3><p><code></code><br>int()  # 转化成整数<br>float() # 转化成浮点数<br>str() # 转化成字符<br>type() # 查看格式</p>
<p><code>`</code></p>

        
      </div>
      
      
      
    </div>
    
    
    
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://i.loli.net/2019/04/17/5cb735e5570e8.jpg" alt="怪兽宇">
            
              <p class="site-author-name" itemprop="name">怪兽宇</p>
              <p class="site-description motion-element" itemprop="description">个人博客</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">56</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">56</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/zhangandyu" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="zhangyu756897669@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/p/1005052177096132?sudaref=zhangandyu.github.io&display=0&retcode=6102&sudaref=passport.weibo.com" target="_blank" title="微博">
                      
                        <i class="fa fa-fw fa-weibo"></i>微博</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-globe"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.ruanyifeng.com/blog/" title="阮一峰的网络日志" target="_blank">阮一峰的网络日志</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://christophrehage.cn/" title="christoph rehage" target="_blank">christoph rehage</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.chinawebanalytics.cn/" title="互联网分析在中国" target="_blank">互联网分析在中国</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Pandas简介"><span class="nav-number">1.</span> <span class="nav-text">Pandas简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#常用的软件"><span class="nav-number">2.</span> <span class="nav-text">常用的软件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Series对象"><span class="nav-number">3.</span> <span class="nav-text">Series对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#时间函数"><span class="nav-number">3.0.1.</span> <span class="nav-text">时间函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读取与写入Excel数据"><span class="nav-number">3.0.2.</span> <span class="nav-text">读取与写入Excel数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#描述数据"><span class="nav-number">3.0.3.</span> <span class="nav-text">描述数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据清洗"><span class="nav-number">3.0.4.</span> <span class="nav-text">数据清洗</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对数据进行处理"><span class="nav-number">3.0.5.</span> <span class="nav-text">对数据进行处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对数据进行提取-筛选"><span class="nav-number">3.0.6.</span> <span class="nav-text">对数据进行提取,筛选</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据汇总"><span class="nav-number">3.0.7.</span> <span class="nav-text">数据汇总</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据统计"><span class="nav-number">3.0.8.</span> <span class="nav-text">数据统计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对字符串进行操作"><span class="nav-number">3.0.9.</span> <span class="nav-text">对字符串进行操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读取excel-中的各个sheeht名称，并且进行合并"><span class="nav-number">3.0.10.</span> <span class="nav-text">读取excel 中的各个sheeht名称，并且进行合并</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#将运行的所有数据都展现出来，-而不是只展现最后一条"><span class="nav-number">3.0.11.</span> <span class="nav-text">将运行的所有数据都展现出来， 而不是只展现最后一条</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符和数值之间的转化"><span class="nav-number">3.0.12.</span> <span class="nav-text">字符和数值之间的转化</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">怪兽宇</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">111.4k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>


<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>



        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      您是本站第
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      位访客，欢迎您。
    </span>
  

  
    <span class="site-pv">
      本站总访问
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://zhangyu.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'https://zhangandyu.github.io/备份/文章备份/python/Pandas库学习总结.html';
          this.page.identifier = '备份/文章备份/python/Pandas库学习总结.html';
          this.page.title = 'Pandas 库学习总结';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://zhangyu.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
<script type="text/javascript" src="/js/src/love.js"></script>
