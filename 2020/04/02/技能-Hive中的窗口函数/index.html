<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="个人博客"><title>Hive 中的窗口函数 | 怪兽宇的小站</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.1/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.1/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.1/jquery.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/2.0.4/clipboard.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','127783955','auto');ga('send','pageview');
</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Hive 中的窗口函数</h1><a id="logo" href="/.">怪兽宇的小站</a><p class="description">脚踏实地，仰望星空!</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/tool/"><i class="fa fa-yelp"> 工具</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Hive 中的窗口函数</h1><div class="post-meta">2020-04-02<span> | </span><span class="category"><a href="/categories/数据分析技能/">数据分析技能</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1.2k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 4</span><span class="post-meta-item-text"> 分钟</span></span></span></div><a class="disqus-comment-count" href="/2020/04/02/技能-Hive中的窗口函数/#vcomment"><span class="valine-comment-count" data-xid="/2020/04/02/技能-Hive中的窗口函数/"></span><span> 条评论</span></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL-中的排序函数"><span class="toc-number">1.</span> <span class="toc-text">SQL 中的排序函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#rank-dense-rank-row-number函数。"><span class="toc-number">1.1.</span> <span class="toc-text">rank,dense_rank,row_number函数。</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sql中的拼接函数"><span class="toc-number">2.</span> <span class="toc-text">sql中的拼接函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#concat、concat-ws函数"><span class="toc-number">2.1.</span> <span class="toc-text">concat、concat_ws函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sql中的拆分函数"><span class="toc-number">3.</span> <span class="toc-text">sql中的拆分函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL中将数据进行分类整理函数"><span class="toc-number">4.</span> <span class="toc-text">SQL中将数据进行分类整理函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#collect-set函数-case-when函数，explode-函数，-lateral-view函数"><span class="toc-number">4.1.</span> <span class="toc-text">collect_set函数, case_when函数，explode()函数， lateral view函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#case-when-函数"><span class="toc-number">5.</span> <span class="toc-text">case when 函数</span></a></li></ol></div></div><div class="post-content"><h1 id="SQL-中的排序函数"><a href="#SQL-中的排序函数" class="headerlink" title="SQL 中的排序函数"></a>SQL 中的排序函数</h1><h2 id="rank-dense-rank-row-number函数。"><a href="#rank-dense-rank-row-number函数。" class="headerlink" title="rank,dense_rank,row_number函数。"></a>rank,dense_rank,row_number函数。</h2><p>最近别人问自己一个SQL问题，如何找出各省点击人数Top10的按钮，自己没能熟练回答，今天再巩固复习下。</p>
<p><strong>1.明确思路</strong><br>对于这个问题，首先要理清自己的思路：</p>
<ol>
<li>取出 省份、按钮和 uv</li>
<li>各省分组内，按照uv进行从大到小排序，并输出一列排序序号。</li>
<li>根据排序序号，取出排序前10的按钮和省份。</li>
</ol>
<p><strong>2.查找所需函数</strong><br>在这个问题中，我们需要使用排序函数，SQl 中用于排序的函数有：rank、dense_rank、row_number函数,其语法为：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rank() over ([partition by A] order by B  DESC)</span><br><span class="line"></span><br><span class="line">dense_rank() over ([partition by A] order by B DESC)</span><br><span class="line"></span><br><span class="line">row_number() over ([partition by A] order by B DESC )</span><br><span class="line"><span class="comment">-- partition by A 表示 按照A进行分区。</span></span><br><span class="line"><span class="comment">-- order by B 表示按照B进行排序。</span></span><br><span class="line"><span class="comment">-- DESC 表示 从大到小降序排列。</span></span><br><span class="line"><span class="comment">-- 其中[partition by col1]若不需要则可省略不写。</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>我们需要按照 省份 进行分区，并在分区内按照 uv 进行降序排列。</li>
</ul>
<p><strong>3.明确各函数之间的不同点</strong></p>
<ul>
<li>rank函数， 数值相等的排序则会留下空位： 1、2、2、4</li>
<li>dense_rank函数，数值相等的排序不会留下空位: 1、2、2、3</li>
<li>row_number函数，则不区分数值是否相等，默认排序为： 1、2、3、4</li>
<li><ul>
<li>针对点击人数TOP10问题，我们使用 dense_rank函数来进行排序。</li>
</ul>
</li>
</ul>
<p><strong>4.根据思路，写出sql语句</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    province, </span><br><span class="line">    nbtn_name </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">(</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">    province,  <span class="comment">--省份</span></span><br><span class="line">    nbtn_name, <span class="comment">--按钮 </span></span><br><span class="line">    uv,        <span class="comment">--uv</span></span><br><span class="line">    <span class="keyword">dense_rank</span>()<span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> province <span class="keyword">order</span> <span class="keyword">by</span> uv <span class="keyword">DESC</span>) <span class="keyword">as</span> ran <span class="comment">--排序</span></span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">(<span class="keyword">select</span></span><br><span class="line">    province,</span><br><span class="line">    nbtn_name,</span><br><span class="line">    <span class="keyword">count</span>(<span class="keyword">distinct</span> user_account) <span class="keyword">as</span> uv</span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    apache_computer_view.client_android_log </span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">    nbtn_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>  </span><br><span class="line">    <span class="keyword">and</span> </span><br><span class="line">    hit_date = <span class="string">'2020-03-10'</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">    province,</span><br><span class="line">    nbtn_name))</span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">    ran &lt;= <span class="number">10</span></span><br></pre></td></tr></table></figure></p>
<h1 id="sql中的拼接函数"><a href="#sql中的拼接函数" class="headerlink" title="sql中的拼接函数"></a>sql中的拼接函数</h1><h2 id="concat、concat-ws函数"><a href="#concat、concat-ws函数" class="headerlink" title="concat、concat_ws函数"></a>concat、concat_ws函数</h2><p>拼接函数主要用于我们希望将跑出来的结果进行拼接，以便达到业务的需求。 比如：我们需要写出每个省份对应的每个城市的活跃人数。</p>
<p><strong>1.明确思路</strong></p>
<ol>
<li>求出省份、城市、uv</li>
<li>对省份和城市进行合并</li>
</ol>
<p><strong>2.查找所需函数</strong><br>在sql中常用的拼接函数有： concat、concat_ws函数， 其语法为：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">concat(string A, stringB...)</span><br><span class="line"></span><br><span class="line">CONCAT_WS( 分隔符, string A, string B... )</span><br></pre></td></tr></table></figure></p>
<p><strong>3.区分两函数之间的不同点</strong></p>
<ul>
<li>concat函数在连接字符串时，只要其中一个是NUll，则返回NUll</li>
<li>concat_ws函数则，只要有一个字符串不是NUll， 则不会返回NULL。</li>
<li>concat_ws需要指定分隔符,而concat函数不需要。</li>
</ul>
<p><strong>4.根据思路，写出sql语句。</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">concat(province,&apos;-&apos;, city), uv </span><br><span class="line">--concat_ws(&apos;-&apos;, province, city), uv </span><br><span class="line">from </span><br><span class="line">(select </span><br><span class="line">    province, </span><br><span class="line">    city,</span><br><span class="line">    count(distinct user_account) as uv </span><br><span class="line">from </span><br><span class="line">apache_computer_view</span><br><span class="line">where </span><br><span class="line">hit_date = &apos;2020-03-01&apos;</span><br><span class="line">group by </span><br><span class="line">province, city)</span><br></pre></td></tr></table></figure></p>
<p><strong>5.输出结果</strong></p>
<table>
<thead>
<tr>
<th>省-城市</th>
<th>uv</th>
</tr>
</thead>
<tbody>
<tr>
<td>河北省-保定</td>
<td>11189</td>
</tr>
<tr>
<td>山西省-阳泉市</td>
<td>13</td>
</tr>
<tr>
<td>河南省-信阳</td>
<td>7462</td>
</tr>
</tbody>
</table>
<hr>
<h1 id="sql中的拆分函数"><a href="#sql中的拆分函数" class="headerlink" title="sql中的拆分函数"></a>sql中的拆分函数</h1><p>有时根据业务要求，我们也需要用sql将一些字段拆解出来进行使用，比如：Syjh-sjsy-zygn-3_1字段，我们只需要Syjh-sjsy-zygn位置的所有按钮。 </p>
<p>1.明确思路</p>
<ol>
<li>取出按钮、位置、uv，并根据要求对位置进行拆分</li>
<li>根据拆分好的位置中，取出所有按钮</li>
</ol>
<p>2.查找所需的函数<br>在sql中常用的拆分函数有：substr、substring、substring_index, split, lateral view 函数，其语法分别为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">substr(A，开始截取的位置)</span><br><span class="line"></span><br><span class="line">substring( A, k开始截取的位置，截取长度)</span><br><span class="line"></span><br><span class="line">substring_index(A, 分割的字符,截取字符的位置)</span><br><span class="line"></span><br><span class="line">split(A, 分割的字符)</span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>区分函数之前的区别<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>substring,<br>substring_index,<br>split<br><a href="https://blog.csdn.net/lxpbs8851/article/details/18712407" target="_blank" rel="noopener">https://blog.csdn.net/lxpbs8851/article/details/18712407</a></p>
<h1 id="SQL中将数据进行分类整理函数"><a href="#SQL中将数据进行分类整理函数" class="headerlink" title="SQL中将数据进行分类整理函数"></a>SQL中将数据进行分类整理函数</h1><h2 id="collect-set函数-case-when函数，explode-函数，-lateral-view函数"><a href="#collect-set函数-case-when函数，explode-函数，-lateral-view函数" class="headerlink" title="collect_set函数, case_when函数，explode()函数， lateral view函数"></a>collect_set函数, case_when函数，explode()函数， lateral view函数</h2><p>case_when函数</p>
<ol>
<li><p>语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">collect_set(col)</span><br></pre></td></tr></table></figure>
</li>
<li><p>案例</p>
</li>
</ol>
<ul>
<li><p>求将每个省的城市列出来</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    province, </span><br><span class="line">    collect_set(city)</span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">apache_computer_view.client_android_log </span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">hit_date = <span class="string">'2020-03-01'</span></span><br><span class="line"><span class="keyword">and</span> </span><br><span class="line">nbtn_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span> </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">province</span><br><span class="line"></span><br><span class="line"><span class="comment">---辽宁省	["营口市","大连","大连市","抚顺市","铁岭","盘锦","锦州","沈阳市","辽阳","鞍山","铁岭市","本溪市","丹东市","丹东","沈阳","朝阳市","锦州市","辽阳市","阜新市","鞍山市","盘锦市","葫芦岛","营口","抚顺","葫芦岛市","阜新","本溪","朝阳"]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>求出一个月内活跃天数大于20天的用户数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--先列出每个用户的所有登陆时间</span></span><br><span class="line"><span class="comment">--选出需要的时间段</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    <span class="keyword">count</span>(<span class="keyword">distinct</span> user_account) <span class="keyword">as</span> uv </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    (<span class="keyword">select</span> </span><br><span class="line">        user_account,</span><br><span class="line">        collect_set(hit_date) <span class="keyword">as</span> t</span><br><span class="line">    <span class="keyword">from</span> </span><br><span class="line">        apache_computer_view.client_android_log </span><br><span class="line">    <span class="keyword">where</span> </span><br><span class="line">        hit_date <span class="keyword">between</span> <span class="string">'2020-03-01'</span> <span class="keyword">and</span> <span class="string">'2020-03-31'</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">        user_account) <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">    <span class="keyword">size</span>(a.t) &gt;= <span class="number">20</span></span><br><span class="line"><span class="comment">--手机号对应日期长度 &gt;= 20</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="case-when-函数"><a href="#case-when-函数" class="headerlink" title="case when 函数"></a>case when 函数</h1><p><a href="https://www.cnblogs.com/kimbo/p/6208973.html" target="_blank" rel="noopener">https://www.cnblogs.com/kimbo/p/6208973.html</a> 行列转换</p>
<p><a href="https://analyticshut.com/pivot-rows-to-columns-hive/" target="_blank" rel="noopener">https://analyticshut.com/pivot-rows-to-columns-hive/</a></p>
<p><a href="https://analyticshut.com/hive-collect-set-vs-collect-list/" target="_blank" rel="noopener">https://analyticshut.com/hive-collect-set-vs-collect-list/</a></p>
<p><a href="http://leanote.com/blog/post/5b336f08ab64416e23001ace" target="_blank" rel="noopener">http://leanote.com/blog/post/5b336f08ab64416e23001ace</a></p>
<p><a href="http://leanote.com/blog/post/5b30cf4aab64413846001ac9" target="_blank" rel="noopener">http://leanote.com/blog/post/5b30cf4aab64413846001ac9</a></p>
</div><script type="text/javascript" src="/copyright/js/copyright.js"></script><link rel="stylesheet" type="text/css" href="/copyright/css/copyright.css"><div class="post-copyright"><p><span>本文标题：</span>Hive 中的窗口函数</p><p><span>文章作者：</span>怪兽宇</p><p><span>发布时间：</span>2020-04-02</p><p><span>最后更新：</span>2020-04-07</p><p><span>原始链接：</span><a href="/2020/04/02/技能-Hive中的窗口函数/">https://zhangandyu.github.io/2020/04/02/技能-Hive中的窗口函数/</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="https://zhangandyu.github.io/2020/04/02/技能-Hive中的窗口函数/"></i></span></p><p><span>版权声明：</span>本文所有权归博主所有，转载请注明署名、出处！Thanks</p></div><br><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://zhangandyu.github.io/2020/04/02/技能-Hive中的窗口函数/" data-id="ck8s72sve001dk0qk7pbfej4p" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACsklEQVR42u3c0WrDMAwF0P7/T3evg5H0SrLaDk6eSpYlPi7E3pXY4xEfz9vj7zW/z1zd4e/982cdPvDw8PCWh34PuKfen0nuWZ4CPDw8vDXe1Rv16prn+MgHnYzn8jweHh7e1/DybXR1Eao+BQ8PD++/8PKtcHWjXP0tPDw8vE/xetvZJFzIY9xetHEsa8HDw8NbqCJ9z+eV+h4eHh7euKpeLfbn2/Reeaw8Wjw8PLwFXv7CzRsLqmX+s9tlPDw8vPfz8taoFzcdlMful59y6IyHh4e3xssByZXJmUkjVz5yPDw8vA1eEhOcihiqm/Vq69Xls/Dw8PAO8ap/8Fcjg/kS0rsPHh4e3h5vHkZUA9lq21avJIaHh4f3Hl6vvJQHCpOYuNdhhYeHh7fB6wUQSTPW5HVfDZqj7w0PDw/vEK8a1OZh7mSL3Nu4X04EHh4e3hrv/kWfN0Xlg5u3aiVjxsPDw9vgVV/x1TJ/dfp6ZbZCnIGHh4e3wDvVhlWNHvISWi/UwMPDwzvFm7zoq6Hq2bA4Cnzx8PDw1nj3y0NyPlkwkiXn1E/x8PDw9njJcOdl/moRq9dAcHkHPDw8vEO8HmmSeeRFr0mBbfSN4eHh4aVpQ/lflmxshfemAA8PD+8sL9ngJnWzyRLSuzKaGjw8PLxl3rwolYcF+Ya+Nx48PDy8T/HyM+WiVBDyViervDDg4eHhDXhJyb+3kFRJj9bxYmHAw8PDO8R7Fo+99qn5Bjpa8fDw8PBOZgWP3mLQazuoFr2qn8tIPDw8vCIvWQyqszVpJpgUzPDw8PDeyctDijx0SAKLcnZSLa3h4eHhfQ2vt7E+WzArhLl4eHh4X8DLp2CywFSj4eZM4OHh4bV4+Ss7bwvopch5w0G0nODh4eEt8ObRQDWemBTVqlEFHh4e3lHeD908QQWe2I2XAAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/tags/Hive/"><i class="fa fa-tag"></i>Hive</a><a href="/tags/数据分析/"><i class="fa fa-tag"></i>数据分析</a></div><div class="post-nav"><a class="next" href="/2020/03/20/生活-个人总结-博客主题更换/">博客主题更换</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' ? true : false;
var verify = 'true' ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'LWPB8jjoMUiH98OUCjulreBj-gzGzoHsz',
  appKey:'YOWrXQ1oP2QTavuCRp2QeRYV',
  placeholder:'　快来留下你的脚印吧',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/个人系统/">个人系统</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据分析技能/">数据分析技能</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据分析方法/">数据分析方法</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活资料/">生活资料</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a><span class="category-list-count">5</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/04/02/技能-Hive中的窗口函数/">Hive 中的窗口函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/20/生活-个人总结-博客主题更换/">博客主题更换</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/03/方法-数据异常分析/">数据异常分析方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/02/生活-个人总结-利用环境来辅助自己的进步/">利用环境来辅助自己进步</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/29/方法-如何用数据说话/">如何用数据说话</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/01/技能-数据分析-培养数据敏感度/">培养数据敏感度</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/22/方法-改版分析/">改版分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/12/方法-常用指标/">搭建业务运营指标</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/07/技能-Hive进阶学习/">Hive 进阶查询</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/22/方法-营销活动分析/">营销活动分析</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Hive/" style="font-size: 15px;">Hive</a> <a href="/tags/sql/" style="font-size: 15px;">sql</a> <a href="/tags/数据分析/" style="font-size: 15px;">数据分析</a> <a href="/tags/统计学/" style="font-size: 15px;">统计学</a> <a href="/tags/岗位介绍/" style="font-size: 15px;">岗位介绍</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/数据敏感度/" style="font-size: 15px;">数据敏感度</a> <a href="/tags/常用指标/" style="font-size: 15px;">常用指标</a> <a href="/tags/报告/" style="font-size: 15px;">报告</a> <a href="/tags/活动分析/" style="font-size: 15px;">活动分析</a> <a href="/tags/改版分析/" style="font-size: 15px;">改版分析</a> <a href="/tags/学习方法/" style="font-size: 15px;">学习方法</a> <a href="/tags/读书笔记/" style="font-size: 15px;">读书笔记</a> <a href="/tags/思维方法/" style="font-size: 15px;">思维方法</a> <a href="/tags/思考方法/" style="font-size: 15px;">思考方法</a> <a href="/tags/心理/" style="font-size: 15px;">心理</a> <a href="/tags/方法/" style="font-size: 15px;">方法</a> <a href="/tags/异常分析/" style="font-size: 15px;">异常分析</a> <a href="/tags/书单/" style="font-size: 15px;">书单</a> <a href="/tags/工具/" style="font-size: 15px;">工具</a> <a href="/tags/逻辑/" style="font-size: 15px;">逻辑</a> <a href="/tags/类比/" style="font-size: 15px;">类比</a> <a href="/tags/音乐/" style="font-size: 15px;">音乐</a> <a href="/tags/博客主题/" style="font-size: 15px;">博客主题</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.ruanyifeng.com/blog/" title="阮一峰的网络日志" target="_blank">阮一峰的网络日志</a><ul></ul><a href="http://www.chinawebanalytics.cn/" title="互联网分析在中国" target="_blank">互联网分析在中国</a><ul></ul><a href="https://www.yangzhiping.com/" title="阳志平的网志" target="_blank">阳志平的网志</a><ul></ul><a href="https://maxoxo.me/" title="maxOS" target="_blank">maxOS</a><ul></ul><a href="https://thelongestway.com/" title="The Longest Way" target="_blank">The Longest Way</a><ul></ul><a href="https://christophrehage.cn/" title="Christoph Rehage" target="_blank">Christoph Rehage</a><ul></ul><a href="https://codechina.org/" title="Tinyfool的中文Blog" target="_blank">Tinyfool的中文Blog</a><ul></ul><a href="http://sunny.blogchina.com/" title="梁宁的专栏" target="_blank">梁宁的专栏</a><ul></ul><a href="https://ayearofreadingtheworld.com/" title="A year of reading the world" target="_blank">A year of reading the world</a><ul></ul><a href="http://www.storytellingwithdata.com/blog/" title="storytelling-data" target="_blank">storytelling-data</a><ul></ul><a href="https://github.com/xiaolai/xiaolai.github.io" title="李笑来网站" target="_blank">李笑来网站</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">怪兽宇的小站.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/love/js/love.js"></script><script type="text/javascript" src="/copycode/js/copycode.js"></script><link rel="stylesheet" type="text/css" href="/copycode/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>